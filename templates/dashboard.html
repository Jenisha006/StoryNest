{% extends "base.html" %}

{% block title %}Dashboard â€“ StoryNest{% endblock %}

{% block content %}

<div class="dashboard-page">

  <!-- HEADER -->
  <div class="dashboard-header">
    <div>
      <h1>Your Dashboard</h1>
      <p>Manage all your stories and articles in one place</p>
    </div>
    <a href="{{ url_for('add_article') }}" class="btn-primary" style="display:flex; align-items:center; gap:0.5rem;">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
        <line x1="12" y1="5" x2="12" y2="19"/>
        <line x1="5" y1="12" x2="19" y2="12"/>
      </svg>
      Add New Article
    </a>
  </div>

  <!-- STATS -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-label">Total Articles</div>
      <div class="stat-value">{{ total }}</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Published</div>
      <div class="stat-value published">{{ published }}</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Drafts</div>
      <div class="stat-value drafts">{{ drafts }}</div>
    </div>
  </div>

  <!-- ARTICLES TABLE -->
  <div class="articles-table">

    <div class="table-header">
      <span>Article Title</span>
      <span>Category</span>
      <span>Date</span>
      <span>Actions</span>
    </div>

    {% for article in articles %}
    <div class="table-row">
      <div class="row-title">{{ article.title }}</div>
      <div class="row-category">{{ article.category }}</div>
      <div class="row-date">{{ article.date }}</div>
      <div class="row-actions">

        <!-- VIEW -->
        <a class="action-btn" href="{{ url_for('article', article_id=article.id) }}" title="View">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
            <circle cx="12" cy="12" r="3"/>
          </svg>
        </a>

        <!-- EDIT -->
        <a class="action-btn" href="{{ url_for('edit_article', article_id=article.id) }}" title="Edit">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
          </svg>
        </a>

        <!-- DELETE -->
        <form method="POST" action="{{ url_for('delete_article', article_id=article.id) }}" onsubmit="return confirm('Are you sure you want to delete this article?')">
          <button type="submit" class="action-btn delete" title="Delete">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="3 6 5 6 21 6"/>
              <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/>
              <path d="M10 11v6M14 11v6"/>
              <path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/>
            </svg>
          </button>
        </form>

      </div>
    </div>
    {% else %}
    <div style="padding:2rem 1.5rem; color:var(--text-mid); font-size:0.9rem;">
      No articles yet. Click "Add New Article" to get started!
    </div>
    {% endfor %}

  </div>
</div>

{% endblock %}